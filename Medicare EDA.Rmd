---
title: "SURE EDA Project"
author: "Akwell√© (Q) Quaye"
date: '2022-06-14'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
medicare <- read_csv("http://www.stat.cmu.edu/cmsac/sure/2022/materials/data/health/eda_projects/medicare_partd_presc_claims.csv")
```


#avg claims per state, by opioid flag


```{r}
avgNumClaims <- medicare %>%
  group_by(state = State, opioid = OpioidFlag) %>%
  summarize(meanNumClaims = mean(NumberClaims))
  
avgNumClaims %>%
  ggplot(aes(x = opioid, y=meanNumClaims)) +
  geom_bar(stat="identity", fill='red') +
  facet_wrap(~ state) +
  
  theme_minimal()


```
# average claims per state with non-opioids removed

``` {r}
opioidOnly <- medicare %>%
  filter(OpioidFlag == "Opioid") %>%
  group_by(state = State) %>%
  summarize(meanNumClaims = mean(NumberClaims))

opioidOnly %>%
  ggplot(aes(x = state, y=meanNumClaims)) +
  geom_bar(stat="identity", fill='red') +
  theme_minimal()

```
#usmap of above data

```{r}
library(usmap)

opioidOnly <- medicare %>%
  filter(OpioidFlag == "Opioid") %>%
  group_by(state = State) %>%
  summarize(meanNumClaims = mean(NumberClaims))



plot_usmap(data=opioidOnly, values="meanNumClaims", color='red')


```

```{r}

#usmap of above data

```{r}
library(usmap)

opioidOnly <- medicare %>%
  filter(OpioidFlag == "Opioid") %>%
  group_by(state = State) %>%
  summarize(meanNumClaims = mean(NumberClaims))



plot_usmap(data=opioidOnly, values="meanNumClaims", color='red')



```
```
